---
author: jason
comments: true
date: 2010-08-16 15:05:23+00:00
layout: news_item
slug: bash-commands-to-detect-script-injections-and-malware
title: Bash commands to detect script injections and malware
wordpress_id: 126
categories:
- Security
---

<p>Not so long ago this site and other domains hosted on my server were injected with malware PHP scripts that caused all sorts of damage, including amending javascript files to display ads to people who visited my sites.</p>

<p>These 2 bash commands saved my life and I would like to share them with the world.</p>

<p>The first one will find any javascript file that contains the string "eval(unescape" which is the most common way of injecting malicious code. The second is a similar method for PHP files.</p>


{% highlight text %}

find . -name "*.js" | xargs grep -l "eval(unescape"
find . -name "*.php" | xargs grep -l "eval(base64_decode"

{% endhighlight %}


<p>Seek and destroy!</p>

